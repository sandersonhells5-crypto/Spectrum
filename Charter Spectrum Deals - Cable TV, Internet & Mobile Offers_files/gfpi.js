!function(){function o(){this.algos=[]}function e(o,e){this.Value=o,void 0!==e&&(this.ConfidenceScore=e)}function t(o,t){return new Promise((function(n,i){if(!window.Cfv4||"function"!=typeof window.Cfv4.OnComplete)return i("window.Cfv4 not found");Cfv4.SetIpv4(o),Cfv4.SetApiBaseUrl(t),Cfv4.OnComplete((function(o){if(!o||"string"!=typeof o._finalFp)return i("Missing result._finalFp");n(new e(o._finalFp))})),Cfv4.OnError((function(o){i("Request to API failed: "+o)}))}))}setTimeout((function(){(new o).registerAlgo("cfv4","10.17.js",t).run()}),0),o.prototype.DEV_S3_BUCKET_MAP={"fprintapi.centerfielddev.com":"cf-gfpi-stg2"},o.prototype.LOCALIZED_PREFIX={"www.att.com":"/cfd","pre-www.att.com":"/cfd","dev.finalstageatt.centerfieldstaging.com":"/cfd","www.adt.com":"/cf","stage-web.adt.com":"/cf","www.clover.com":"/deals","www.staging.clover.com":"/deals","www.viasat.com":"/cf","viasat.com":"/cf","www.optimum.com":"/cf","optimum.com":"/cf","internet.centurylink.com":"/lp"},o.prototype.GET_CLIENT_IPV4_URL="https://fpv4.cfdomains.com",o.prototype.ALGO_DEP_URL_PREFIX="https://{envBucket}.s3.us-west-2.amazonaws.com/algos/",o.prototype.COOKIE_NAME="gfpi_v20240813",o.prototype.COOKIE_EXPIRY_SECONDS=2592e3,o.prototype.SUBID_DISCOVERY_MAX_ATTEMPTS=200,o.prototype.SUBID_DISCOVERY_MS_BETWEEN_ATTEMPTS=25,o.prototype.API_BASE_URL="https://{envHost}/api",o.prototype.RECORD_EVENT_API_URL="/Event/RecordEvent",o.prototype.EVENT_ID={initial_page_visit:1},o.prototype.run=function(){var o=this;if("function"!=typeof window.fetch||"function"!=typeof window.Promise)return console.warn("[gfpi.js]","Insufficient browser support","Aborting...");if(o.selfUrl=o.getSelfUrl(),!o.selfUrl)return console.warn("[gfpi.js]","Unable to locate self in DOM","Aborting...");o.configureEndpoints();var e=!1,t=!1,n=null;function i(){e&&t&&n&&(n.forEach((function(e){"cfv4"===e.Key&&(e.Value=Cfv4.ApplyIpv4ToResult(e.Value,o.ipv4))})),o.saveResults(n),o.setCookie(o.COOKIE_NAME,o.subid,o.COOKIE_EXPIRY_SECONDS))}return o.locateSubid().then((function(t){if(o.subid=t,!o.subid)return console.warn("[gfpi.js]","Unable to locate subid","Aborting...");var n=o.readCookie(o.COOKIE_NAME);if(n==o.subid)return console.log("[gfpi.js]","Already ran for subid:",o.subid,"Aborting...");console.log("[gfpi.js]","Previous subid:",n,"New subid:",o.subid),e=!0,i()})),o.collectIps().then((function(){if(!o.ipv4)return console.warn("[gfpi.js]","Failed to fetch pre-reqs","Aborting...");t=!0,i()})),o.runAlgos().then((function(o){if(!o.length)return console.warn("[gfpi.js]","No algos run","Aborting...");n=o,i()})),o},o.prototype.registerAlgo=function(o,e,t){return this.algos.push({name:o,src:e,cb:t}),this},o.prototype.runAlgos=function(){var o=this;return new Promise((function(e){for(var t=[],n=0,i=0;i<o.algos.length;++i)!function(){var e=o.algos[i];o.loadScript(o.ALGO_DEP_URL_PREFIX+e.src,(function(t){if(t)return r.call(e,t);e.cb(o.ipv4,o.API_BASE_URL).then(r.bind(e,!1)).catch(r.bind(e))}))}();function r(i,r){i?console.error("[gfpi.js]","Algo error",this.name,i):Array.isArray(r)?(t.push((r[0].Key=this.name)&&r[0]),t.push(r[1])):t.push((r.Key=this.name)&&r),++n==o.algos.length&&e(t)}}))},o.prototype.saveResults=function(o){window.fetch(this.API_BASE_URL+this.RECORD_EVENT_API_URL,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({EventTypeId:this.EVENT_ID.initial_page_visit,SubId:this.subid,FullUrl:window.location.href,Identifiers:o}),keepalive:!0}).then((function(o){if(!o.ok)return console.error("[gfpi.js]","saveResults()","Error: Response code not 2xx",o.status);console.log("[gfpi.js]","saveResults()","Success!")})).catch((function(o){console.error("[gfpi.js]","saveResults()","Error","Failed to make API call",o)}))},o.prototype.collectIps=function(){var o=this;return o.ipv4=null,new Promise((function(e){if(o.DEV_S3_BUCKET_MAP[o.selfUrl.hostname])return o.ipv4="dev",e();window.fetch(o.GET_CLIENT_IPV4_URL).then((function(t){if(!t.ok)return e();t.text().then((function(t){o.ipv4=t,e()})).catch(e)})).catch(e)}))},o.prototype.locateSubid=function(){var o=this;return new Promise((function(e){var t;if(t=o.qs("subid"))return e(t);if(t=o.qs("subid",o.selfUrl.search),o.validateSubId(t))return console.log("[gfpi.js]","Found subid in script src:",t),e(t);var n=0;!function i(){return t=window.subid||window.subId,o.validateSubId(t)?(console.log("[gfpi.js]","Found subid in global variable:",t),e(t)):(t=o.readCookie("s1_click-token-combined"),o.validateSubId(t)?(console.log("[gfpi.js]",'Found subid in cookie "s1_click-token-combined":',t),e(t)):(t=o.readCookie("CF_Trk_S1"),o.validateSubId(t)?(console.log("[gfpi.js]",'Found subid in cookie "CF_Trk_S1":',t),e(t)):(t=o.readCookie("parentclick")+"."+o.readCookie("CF_Trk_S"),o.validateSubId(t)?(console.log("[gfpi.js]",'Found subid in cookie "parentclick" and "CF_Trk_S":',t),e(t)):(t=o.readCookie("s1"),o.validateSubId(t)?(console.log("[gfpi.js]",'Found subid in cookie "s1":',t),e(t)):(t=o.readCookie("cf_dg_clk_id")+"."+o.readCookie("ckm_request_id"),o.validateSubId(t)?(console.log("[gfpi.js]",'Found subid in cookie "cf_dg_clk_id" and "ckm_request_id":',t),e(t)):(t=o.readCookie("rc_cid")+"."+o.readCookie("rc_sid"),o.validateSubId(t)?(console.log("[gfpi.js]",'Found subid in cookie "rc_cid" and "rc_sid":',t),e(t)):(t=o.readCookie("rc_sid"),o.validateSubId(t)?(console.log("[gfpi.js]",'Found subid in cookie "rc_sid":',t),e(t)):++n<o.SUBID_DISCOVERY_MAX_ATTEMPTS?setTimeout(i,o.SUBID_DISCOVERY_MS_BETWEEN_ATTEMPTS):void e(null))))))))}()}))},o.prototype.SUBID_REGEX=/^\s*((\d+\.)?\d+\.\d+)\s*$/,o.prototype.validateSubId=function(o){return"string"==typeof o&&this.SUBID_REGEX.test(o)},o.prototype.getSelfUrl=function(){for(var o=0;o<document.scripts.length;++o){var e=document.scripts[o]&&document.scripts[o].src;if(this.looksLikeSelfUrl(e))try{var t=new URL(e);if(t&&t.hostname)return t}catch(o){}}return null},o.prototype.configureEndpoints=function(){var o=this;if(o.DEV_S3_BUCKET_MAP[o.selfUrl.hostname])return o.ALGO_DEP_URL_PREFIX=o.ALGO_DEP_URL_PREFIX.replace("{envBucket}",o.DEV_S3_BUCKET_MAP[o.selfUrl.hostname]),void(o.API_BASE_URL=o.API_BASE_URL.replace("{envHost}",o.selfUrl.hostname));-1!=(o.selfUrl.pathname||"").indexOf("/fprintapi/")?(o.ALGO_DEP_URL_PREFIX="/fprints3/algos/",o.API_BASE_URL="/fprintapi/api"):(o.ALGO_DEP_URL_PREFIX="/tms3/algos/",o.API_BASE_URL="/tmapi/api"),o.LOCALIZED_PREFIX[o.selfUrl.hostname]&&(o.ALGO_DEP_URL_PREFIX=o.LOCALIZED_PREFIX[o.selfUrl.hostname]+o.ALGO_DEP_URL_PREFIX,o.API_BASE_URL=o.LOCALIZED_PREFIX[o.selfUrl.hostname]+o.API_BASE_URL)},o.prototype.looksLikeSelfUrl=function(o){return"string"==typeof o&&-1!=o.indexOf("/gfpi.js")},o.prototype.qs=function(o,e){void 0===e&&(e=window.location.search);var t=("string"==typeof e?e:"").match(new RegExp("(^|\\?|&)"+o+"=(.+?)($|&)"));return t&&t[2]||""},o.prototype.readCookie=function(o){var e=(document.cookie||"").match(new RegExp("(^|;\\s*)"+o+"=([^;]+)(;|$)"));return e&&e[2]?decodeURIComponent(e[2]):null},o.prototype.setCookie=function(o,e,t){var n=(window.location.hostname||"").split("."),i=n.slice(-2).join("."),r=n.slice(-3).join("."),s=o+"="+encodeURIComponent(e)+"; domain=%domain%; path=/"+(t?"; max-age="+t:"")+"; secure; samesite=lax";document.cookie=s.replace("%domain%",i),r!=i&&(document.cookie=s.replace("%domain%",r))},o.prototype.loadScript=function(o,e){var t=document.createElement("script");t.async=!0,t.src=o,t.onload=e.bind(null,!1),t.onerror=e,(document.body||document.head).appendChild(t)}}();